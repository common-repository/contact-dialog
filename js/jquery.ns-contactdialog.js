(function(c,b,a){a.fn.nsContactDialog=function(e){var d,i,g,f,h,j;i={recaptcha_id:"recaptcha",recaptcha_theme:"clean",url:"/"};h=a.extend(i,e);g=a("<div />");g.dialog({autoOpen:false,modal:true,width:510});d=a(h.contact_form);j=a("<div />").appendTo(d);d.validate();d.bind("submit",function(){j.text(h.working_message).addClass("status-message");if(d.valid()){a.getJSON(h.url,d.serialize()+"&nscontactdialog="+h.nscontactdialog+"&nscdaction="+h.nscdaction,function(k,l){j.text(k.message);if("success"===k.response){a(":input",d).attr("readonly","readonly");a(":input:not([type=submit])",d).addClass("submitted-success")}else{if("recaptcha"===k.type){Recaptcha.reload();a("#"+h.recaptcha_id).focus()}if("email"===k.type){a("input[name=email_address]",d).focus()}}})}else{j.text(h.invalid_message)}return false});d.appendTo(g);a.getScript("http://www.google.com/recaptcha/api/js/recaptcha_ajax.js",function(){Recaptcha.create(h.recaptcha_api_public_key,h.recaptcha_id,{theme:h.recaptcha_theme});g.bind("dialogclose",function(l,k){a(":input:not([type=submit])",d).val("").removeAttr("readonly");a(":input:not([type=submit])",d).removeClass("submitted-success");Recaptcha.destroy();Recaptcha.create(h.recaptcha_api_public_key,h.recaptcha_id,{theme:h.recaptcha_theme});j.text("");j.removeClass("status-message")})});a("."+h.contact_link_class+", ."+h.contact_link_class+" a").bind("click",function(){g.dialog("open");return false});return this}}(this,document,jQuery,undefined));